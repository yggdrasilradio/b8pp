1DEFFNI(R,C)=(R-1)*3+C\DIMA(9),C(24)\FORI=1TO24\READC(I)\NEXTI
5PRINT"TIC TAC TOE"\FORI=1TO9\A(I)=I+16\NEXTI\GOSUB100\FORI=1TO9\A(I)=0
6NEXTI
10PRINT\PRINT"Your move";\INPUTM\M=INT(M)\IFM<1THEN15\IFM>9THEN15
11GOTO20
15PRINT"Illegal move"\GOTO10
20IFA(M)<>0THEN15
25A(M)=56\GOSUB100\GOSUB300\IFX=3THEN30\IFN=24THEN40\RANDOM\GOSUB200
26GOSUB100\GOSUB300\IFO=3THEN35\IFN=24THEN40\GOTO10
30PRINT\PRINT"Player wins!"\STOP
35PRINT\PRINT"Computer wins!"\STOP
40PRINT\PRINT"Tie game!"\STOP
100PRINT\FORI=1TO3\PRINT" ";\FORJ=1TO3\PRINTCHR$(A(FNI(I,J))+32);
101IFJ=3THEN110\PRINT" ! ";
110NEXTJ\PRINT\IFI=3THEN120\PRINT"---+---+---"
120NEXTI\RETURN
200GOSUB400\IFM<>0THEN220\IFA(5)>0THEN210\M=5\GOTO220
210M=INT(9*RND(0))+1\IFA(M)<>0THEN210
220A(M)=47\PRINT\PRINT"Computer's move:";M\RETURN
300N=0\FORI=1TO22STEP3\X=0\O=0\FORJ=ITOI+2\IFA(C(J))=0THEN310\N=N+1
310IFA(C(J))<>56THEN320\X=X+1
320IFA(C(J))<>47THEN330\O=O+1
330NEXTJ\IFX<>3THEN340\RETURN
340IFO<>3THEN350\RETURN
350IFN<>24THEN360\RETURN
360NEXTI\RETURN
400M=0\W=0\B=0\FORI=1TO22STEP3\N=0\X=0\O=0\E=0\FORJ=ITOI+2
401IFA(C(J))<>56THEN420\X=X+1\N=N+1
420IFA(C(J))<>47THEN430\O=O+1\N=N+1
430IFA(C(J))>0THEN440\E=C(J)
440NEXTJ\IFN=3THEN460\IFO<>2THEN450\W=E
450IFX<>2THEN460\B=E
460NEXTI\IFW=0THEN470\M=W\RETURN
470IFB=0THEN480\M=B
480RETURN\DATA1,2,3,4,5,6,7,8,9,1,4,7,2,5,8,3,6,9,1,5,9,3,5,7\END
